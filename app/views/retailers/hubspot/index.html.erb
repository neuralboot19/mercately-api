<div class="container-fluid reduced-container-padding mb-16">
  <div class="card">
    <div class="container-fluid index">
      <div class="row middle-xs">
        <div class="col-xs-12 col-sm-8">
          <h1 class="d-inline name">Hubspot</h1>
        </div>
      </div>
    </div>

    <div class="box">
      <div class="row mt-10">
        <div class="col-xs-12">
          <div class="box">
            <%= form_tag update_matching_retailers_hubspot_index_path(current_retailer.slug) do %>
              <div class="row mb-25">
                <div class="px-0 col-sm-3 col-xs-12">
                  <div class="index__desc">
                    <%= label_tag :all_customers_hs_integrated, 'Opciones de sincronización' %>
                  </div>
                  <%= select_tag :all_customers_hs_integrated, options_for_select(@hs_integration_options, current_retailer.all_customers_hs_integrated), class: 'input' %>
                </div>
                <div class="col-xs-12 col-sm-3 fs-14 no-style-filter p-relative">
                  <div class="index__desc">
                    Emparejar por:
                  </div>
                  <%= select_tag :hubspot_match, options_for_select(hubspot_matches_list, current_retailer.hubspot_match), prompt: 'Seleccione uno', class: 'input' %>
                </div>
                <div class="col-xs-12 col-sm-3 fs-14 no-style-filter p-relative">
                  <div>
                    &nbsp;
                  </div>
                  <%= submit_tag 'Guardar', class: 'btn-btn btn-submit h-40' %>
                </div>
              </div>
            <% end %>
          </div>
          <div class="box mb-20">
            <div class="index__desc">
              Seleccione el campo para guardar las etiquetas
            </div>
            <%= form_for :mapped_fields, url: @mapped_field_url do |f| %>
              <%= f.hidden_field :hs_tag, value: true %>
              <div class="row">
                <div class="col-xs-12 col-sm-1 px-0 fs-14  mt-5 no-style-filter ">Mercately: </div>
                <div class="col-xs-12 col-sm-3 px-0 mt-5 fs-14 no-style-filter p-relative">
                  <%= f.select :customer_field, @tags, prompt: 'Seleccione uno', class: 'input' %>
                </div>
                <div class="col-xs-12 col-sm-1 px-0 fs-14 ml-10 mt-5 no-style-filter ">Hubspot: </div>
                <div class="col-xs-12 col-sm-3 px-0 fs-14 mt-5 no-style-filter p-relative">
                  <%= f.select :hubspot_field_id, @hubspot_fields, prompt: 'Seleccione uno', class: 'input' %>
                </div>
                <div class="col-xs-12 col-sm-2 px-0 mt-2 fs-14  t-center no-style-filter p-relative">
                  <%= f.submit 'Guardar', class: 'btn-btn btn-submit h-40' %>
                </div>
              </div>
            <% end %>
          </div>
          <div class="box">
            <div class="index__desc">
              Seleccione los campos a mapear con hubspot
            </div>
            <%= form_for :mapped_fields, url: create_mapped_field_retailers_hubspot_index_path(current_retailer.slug) do |f| %>
              <div class="row">
                <div class="col-xs-12 col-sm-1 px-0 fs-14  mt-5 no-style-filter ">Mercately: </div>
                <div class="col-xs-12 col-sm-3 px-0 mt-5 fs-14 no-style-filter p-relative">
                  <%= f.select :customer_field, @customer_fields, prompt: 'Seleccione uno', class: 'input' %>
                </div>
                <div class="col-xs-12 col-sm-1 px-0 fs-14 ml-10 mt-5 no-style-filter ">Hubspot: </div>
                <div class="col-xs-12 col-sm-3 px-0 fs-14 mt-5 no-style-filter p-relative">
                  <%= f.select :hubspot_field_id, @hubspot_fields, prompt: 'Seleccione uno', class: 'input' %>
                </div>
                <div class="col-xs-12 col-sm-2 px-0 mt-2 fs-14  t-center no-style-filter p-relative">
                  <%= f.submit 'Agregar', class: 'btn-btn btn-submit h-40' %>
                </div>
              </div>
              <% if flash[:notice] == 'Error al mapear campo.' %>
                <div class="row">
                  <div class="col-xs-12 px-0 fs-14 mt-5 c-red">Los campos deben ser del mismo tipo</div>
                </div>
              <% end %>
            <% end %>
          </div>
          <div class="box mt-15">
            <div class="index__desc">
              Actualizar campos de Hubspot
            </div>
            <div class="row">
              <div class="col-xs-12 px-0 fs-12 mt-5 c-grey">
                <i>Al actualizar la lista de los campos de Hubspot se borrarán los campos que ya no existan en Hubspot (incluidos los campos ya mapeados)</i>
              </div>
              <div class="col-xs-12 px-0 fs-14 mt-15">
                <%= link_to 'Actualizar', update_properties_retailers_hubspot_index_path(current_retailer), class: 'btn-btn btn-submit h-40' %>
              </div>
            </div>
          </div>

          <div class="box mt-30">
            <%= form_tag update_sync_conversation_retailers_hubspot_index_path(current_retailer.slug) do %>
              <div class="row mb-25">
                <div class="px-0 col-sm-3 col-xs-12">
                  <div class="index__desc">
                    <%= label_tag :hs_sync_conversation, 'Sincronizar conversaciones' %>
                  </div>
                  <%= select_tag :hs_sync_conversation, options_for_select(hs_sync_options, current_retailer.hs_sync_conversation), class: 'input' %>
                </div>
                <div class="col-xs-12 col-sm-3 fs-14 no-style-filter p-relative">
                  <div class="index__desc">
                    Periodo de tiempo:
                  </div>
                  <%= select_tag :hs_conversacion_sync_time, options_for_select(hs_sync_time_options, current_retailer.hs_conversacion_sync_time), prompt: 'Seleccione uno', class: 'input' %>
                </div>
                <div class="col-xs-12 col-sm-3 fs-14 no-style-filter p-relative">
                  <div>
                    &nbsp;
                  </div>
                  <%= submit_tag 'Guardar', class: 'btn-btn btn-submit h-40' %>
                </div>
              </div>
            <% end %>
          </div>
          <!-- campos mapeados -->
          <div class="container-fluid products mt-50">
            <div class="row">
              <div class="col-xs-12">
                <div class="table box">
                  <div class="table__header row ">
                    <div class="col-xs-12 col-sm-5">Campos de Mercately</div>
                    <div class="col-xs-12 col-sm-5">Campos de Hubspot</div>
                    <div class="col-xs-12 col-sm-2 t-center">Acción</div>
                  </div>
                  <% @hubspot_mapped_fields.each do |mapped_field| %>
                    <div class="divider"></div>
                    <div class="table__item row middle-xs">
                      <div class="col-xs-12 col-sm-5">
                        <div class=""><%= mapped_field.customer_field %></div>
                      </div>
                      <div class="col-xs-12 col-sm-5">
                        <div class=""><%= mapped_field.hubspot_field.hubspot_field %></div>
                      </div>
                      <div class="col-xs-12 col-sm-2 t-center">
                        <td><%= link_to 'Eliminar', delete_mapped_field_retailers_hubspot_index_path(current_retailer,mapped_field), method: :delete, data: { confirm: '¿Está seguro de borrar este campo mapeado?' } %></td>
                      </div>
                    </div>
                  <% end %>
                  <div class="row middle-xs center-xs">
                    <div class="col-xs-12">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <% if @hubspot_mapped_tags.exists? %>
            <div class="container-fluid products mt-50">
              <div class="row">
                <div class="col-xs-12">
                  <div class="table box">
                    <div class="table__header row ">
                      <div class="col-xs-12 col-sm-5">Etiqueta de Mercately</div>
                      <div class="col-xs-12 col-sm-5">Campos de Hubspot</div>
                      <div class="col-xs-12 col-sm-2 t-center">Acción</div>
                    </div>
                    <% @hubspot_mapped_tags.each do |mapped_field| %>
                      <div class="divider"></div>
                      <div class="table__item row middle-xs">
                        <div class="col-xs-12 col-sm-5">
                          <div class=""><%= mapped_field.customer_field %></div>
                        </div>
                        <div class="col-xs-12 col-sm-5">
                          <div class=""><%= mapped_field.hubspot_field.hubspot_field %></div>
                        </div>
                        <div class="col-xs-12 col-sm-2 t-center">
                          <td><%= link_to 'Eliminar', delete_mapped_field_retailers_hubspot_index_path(current_retailer,mapped_field), method: :delete, data: { confirm: '¿Está seguro de borrar este campo mapeado?' } %></td>
                        </div>
                      </div>
                    <% end %>
                    <div class="row middle-xs center-xs">
                      <div class="col-xs-12">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
