<div class="box">
  <div class="row">
    <%= form_for [:retailers, @order], html: { class: 'col-xs-12' } do |f| %>
      <div class="box">
        <div class="row">
          <% if (action_name == 'edit' || action_name == 'update') && @order.meli_order_id.present? %>
            <div class="group col-xs-12 col-md-6">
              <%= f.select :status, Order.statuses.keys.to_a, include_blank: false, disabled: Order.statuses.keys.to_a %>
              <%= f.label :status, 'Status MercadoLibre', class: 'select-label' %>
              <span class="bar"></span>
            </div>
          <% end %>
          <div class="group col-xs-12 col-md-6">
            <%= f.select :customer_id, @retailer.customers.pluck(:meli_nickname, :id), include_blank: false %>
            <%= f.label :customer_id, class: 'select-label' %>
            <span class="bar"></span>
          </div>
          <div class="group col-xs-12 col-md-12">
            <%= f.select :merc_status, Order.merc_statuses.keys.to_a, include_blank: false, disabled: @order.disabled_statuses %>
            <%= f.label :merc_status, 'Status', class: 'select-label' %>
            <span class="bar"></span>
          </div>
          <h3>Items en la orden</h3>
          <div id="order_items" class="w-100">
            <%= f.fields_for :order_items do |oi| %>
              <%= render "order_items_fields", f: oi %>
            <% end %>
            <% if @order.id.blank? || @order.merc_status == 'pending' %>
              <div class="links">
                <%= link_to_add_association 'AÃ±adir item', f, :order_items, partial: 'new_order_items_fields' %>
              </div>
            <% end %>
          </div>

          <div class="btn-box col-xs-12">
            <%= f.submit 'Guardar', class: 'btn-btn btn-submit' %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>

<script src="<%= asset_path 'orders/orders.js' %>" charset="utf-8"></script>
